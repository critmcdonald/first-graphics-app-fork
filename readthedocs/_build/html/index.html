

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>First Graphics App &mdash; First Graphics App  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="First Graphics App  documentation" href="#"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#" class="icon icon-home"> First Graphics App
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">First Graphics App</a><ul>
<li><a class="reference internal" href="#what-you-will-make">What you will make</a></li>
<li><a class="reference internal" href="#about-the-authors">About the authors</a></li>
<li><a class="reference internal" href="#prelude-prerequisites">Prelude: Prerequisites</a></li>
<li><a class="reference internal" href="#chapter-1-hello-git">Chapter 1: Hello Git</a></li>
<li><a class="reference internal" href="#chapter-2-hello-framework">Chapter 2: Hello framework</a></li>
<li><a class="reference internal" href="#chapter-3-hello-template">Chapter 3: Hello template</a></li>
<li><a class="reference internal" href="#chapter-4-hello-data">Chapter 4: Hello data</a></li>
<li><a class="reference internal" href="#chapter-5-hello-table">Chapter 5: Hello table</a></li>
<li><a class="reference internal" href="#chapter-6-hello-chart">Chapter 6: Hello chart</a></li>
<li><a class="reference internal" href="#chapter-7-hello-map">Chapter 7: Hello map</a></li>
<li><a class="reference internal" href="#chapter-8-hello-internet">Chapter 8: Hello Internet</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">First Graphics App</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>First Graphics App</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="first-graphics-app">
<h1>First Graphics App<a class="headerlink" href="#first-graphics-app" title="Permalink to this headline">¶</a></h1>
<p>A step-by-step guide to publishing a standalone story from a dataset.</p>
<p>This tutorial will show you how journalists at America’s top news organizations escape rigid content-management systems to publish custom interactive graphics on deadline. You will get hands-on experience in every stage of the development process, writing JavaScript, HTML and CSS within a Node.js framework. You won’t stop until you’ve deployed a working application on the World Wide Web.</p>
<div class="section" id="what-you-will-make">
<h2>What you will make<a class="headerlink" href="#what-you-will-make" title="Permalink to this headline">¶</a></h2>
<p>By the end of this lesson, you will publish an standalone page with a series of graphics examining the high homicide rate in Harvard Park, a small neighborhood in South Los Angeles. You will do so by repurposing data from <a class="reference external" href="http://www.latimes.com/projects/la-me-harvard-park-homicides/">a 2017 Los Angeles Times story</a> by Nicole Santa Cruz and Cindy Chang.</p>
<p>A working example of what you will make can be found at <a class="reference external" href="https://ireapps.github.io/first-graphics-app/">ireapps.github.io/first-graphics-app/</a></p>
</div>
<div class="section" id="about-the-authors">
<h2>About the authors<a class="headerlink" href="#about-the-authors" title="Permalink to this headline">¶</a></h2>
<p>This guide was prepared for training sessions of <a class="reference external" href="http://www.ire.org/">Investigative Reporters and Editors (IRE)</a>
and the <a class="reference external" href="http://data.nicar.org/">National Institute for Computer-Assisted Reporting (NICAR)</a>
by <a class="reference external" href="http://damihere.com">Dana Amihere</a>, <a class="reference external" href="http://emamd.net">Armand Emamdjomeh</a> and <a class="reference external" href="http://palewi.re/who-is-ben-welsh/">Ben Welsh</a>. It will debut in March 2017 <a class="reference external" href="https://www.ire.org/events-and-training/event/3189/3508/">at NICAR’s conference
in Chicago</a>.</p>
<p>Their work was inspired by the footloose spirit of funk music. We urge you to bust free of the computer systems that constrain your creativity. Hit play and get into the groove.</p>
<iframe src="https://open.spotify.com/embed?uri=spotify:user:227b2koy2xxyb23qliakea75y:playlist:54NS8jCdrgUpzUppUpokSg&theme=white" width="300" height="380" frameborder="0" allowtransparency="true"></iframe></div>
<div class="section" id="prelude-prerequisites">
<h2>Prelude: Prerequisites<a class="headerlink" href="#prelude-prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before you can begin, your computer needs the following tools installed and working:</p>
<ol class="arabic simple">
<li>A <a class="reference external" href="https://en.wikipedia.org/wiki/Command-line_interface">command-line interface</a> to interact with your computer</li>
<li>A <a class="reference external" href="https://en.wikipedia.org/wiki/Text_editor">text editor</a> to work with plain text files</li>
<li>Version x.x or greater of the <a class="reference external" href="https://nodejs.org/en/">Node.js</a> JavaScript runtime</li>
<li>The <a class="reference external" href="https://www.npmjs.com">npm</a> package manager</li>
<li><a class="reference external" href="http://git-scm.com/">Git</a> version control software and an account at <a class="reference external" href="http://www.github.com">GitHub.com</a></li>
</ol>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Stop and make sure you have all these tools installed and working properly. Otherwise, <a class="reference external" href="https://www.youtube.com/watch?v=ynxPshq8ERo">you’re gonna have a bad time</a>.</p>
</div>
<div class="section" id="command-line-prereq">
<span id="id1"></span><h3>Command-line interface<a class="headerlink" href="#command-line-prereq" title="Permalink to this headline">¶</a></h3>
<p>Unless something is wrong with your computer, there should be a way to open a window that lets you type in commands. Different operating systems give this tool slightly different names, but they all have some form of it.</p>
<p>On Windows you can find the command-line interface by opening the “command prompt.” Here are <a class="reference external" href="https://www.bleepingcomputer.com/tutorials/windows-command-prompt-introduction/">instructions</a>.</p>
<p>On Apple computers, you open the <a class="reference external" href="http://blog.teamtreehouse.com/introduction-to-the-mac-os-x-command-line">“Terminal” application</a>.</p>
<p>Ubuntu Linux comes with a program of the <a class="reference external" href="http://askubuntu.com/questions/38162/what-is-a-terminal-and-how-do-i-open-and-use-it">same name</a>.</p>
</div>
<div class="section" id="id2">
<h3>Text editor<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>A program like Microsoft Word, which can do all sorts of text formatting like change the size and color of words, is not what you need. Do not try to use it.</p>
<p>You need a program that works with simple <a class="reference external" href="https://en.wikipedia.org/wiki/Text_file">“plain text” files</a>, and is therefore capable of editing documents containing Python code, HTML markup and other languages without dressing them up by adding anything extra. Such programs are easy to find and some of the best ones are free, including those below.</p>
<p>For Windows, we recommend installing <a class="reference external" href="http://notepad-plus-plus.org/">Notepad++</a>.</p>
<p>For Apple computers, try <a class="reference external" href="https://atom.io">Atom</a> or <a class="reference external" href="https://www.sublimetext.com/">Sublime Text</a>.</p>
<p>In Ubuntu Linux you can stick with the pre-installed <a class="reference external" href="https://help.ubuntu.com/community/gedit">gedit</a> text editor or install a more sophisticated tool like <a class="reference external" href="https://atom.io">Atom</a></p>
</div>
<div class="section" id="id4">
<h3>Node.js<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>TK</p>
</div>
<div class="section" id="id5">
<h3>npm<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>TK</p>
</div>
<div class="section" id="git-and-github">
<h3>Git and GitHub<a class="headerlink" href="#git-and-github" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://git-scm.com/">Git</a> is a version control program for saving the changes you make to files over time. This is useful when you’re working on your own, but quickly becomes essential with large software projects when you work with other developers.</p>
<p><a class="reference external" href="https://github.com/">GitHub</a> is a website that hosts git code repositories, both public and private. It comes with many helpful tools for reviewing code and managing projects. It also has some <a class="reference external" href="http://pages.github.com/">extra tricks</a> that make it easy to publish web pages, which we will use later.</p>
<p>GitHub offers helpful guides for installing Git for <a class="reference external" href="https://help.github.com/articles/set-up-git#platform-windows">Windows</a>, <a class="reference external" href="https://help.github.com/articles/set-up-git#platform-mac">Macs</a> and <a class="reference external" href="https://help.github.com/articles/set-up-git#platform-linux">Linux</a>.</p>
<p>You can verify it’s installed from your command line like so:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git --version
</pre></div>
</div>
<p>Once that’s done, you should create an account at GitHub, if you don’t already have one. <a class="reference external" href="https://github.com/pricing">The free plan</a> is all that’s required to complete this lesson.</p>
</div>
</div>
<div class="section" id="chapter-1-hello-git">
<h2>Chapter 1: Hello Git<a class="headerlink" href="#chapter-1-hello-git" title="Permalink to this headline">¶</a></h2>
<p>Start by creating a new directory where we can store the code for our project. Name it after our application.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># You don&#39;t have to type the &quot;$&quot; It&#39;s just a generic symbol</span>
<span class="c1"># geeks use to show they&#39;re working on the command line.</span>
$ mkdir first-graphics-app
</pre></div>
</div>
<p>Jump into the directory it created.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> first-graphics-app
</pre></div>
</div>
<p>Create a new Git repository in the current directory.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># &quot;.&quot; is a common shortcut to refer to the current directory from the terminal</span>
$ git init .
</pre></div>
</div>
<p>Visit <a class="reference external" href="http://www.github.com">GitHub</a> and create a new public repository named <code class="docutils literal"><span class="pre">first-graphics-app</span></code>. Don’t check “Initialize with README.” You want to start with a blank repository.</p>
<p>Then connect your local directory to GitHub with the following command.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git remote add origin https://github.com/&lt;yourusername&gt;/first-graphics-app.git
</pre></div>
</div>
<p>Create your first file, a blank <code class="docutils literal"><span class="pre">README</span></code> with a <a class="reference external" href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> file extension since that’s <a class="reference external" href="https://help.github.com/articles/github-flavored-markdown">the preferred format of GitHub</a>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Macs or Linux:</span>
$ touch README.md
<span class="c1"># In Windows fire it up in your text editor right away:</span>
$ start notepad++ README.md
</pre></div>
</div>
<p>Open up the README in your text editor and type something in it. Maybe something like:</p>
<div class="highlight-markdown"><div class="highlight"><pre><span></span>My first graphics app
=====================
</pre></div>
</div>
<p>Make sure to save it. Then officially add the file to your repository for tracking with Git’s <code class="docutils literal"><span class="pre">add</span></code> command.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git add README.md
</pre></div>
</div>
<p>Log its creation with Git’s <code class="docutils literal"><span class="pre">commit</span></code> command. You can include a personalized message after the <code class="docutils literal"><span class="pre">-m</span></code> flag.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git commit -m <span class="s2">&quot;First commit&quot;</span>
</pre></div>
</div>
<p>If this is your first time using Git, you may be prompted to configure you name and email. If so, take the time now. Then run the <code class="docutils literal"><span class="pre">commit</span></code> command above again.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git config --global user.email <span class="s2">&quot;your@email.com&quot;</span>
$ git config --global user.name <span class="s2">&quot;your name&quot;</span>
</pre></div>
</div>
<p>Now, finally, push your commit up to GitHub.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git push origin master
</pre></div>
</div>
<p>Reload your repository on GitHub and see your handiwork.</p>
</div>
<div class="section" id="chapter-2-hello-framework">
<h2>Chapter 2: Hello framework<a class="headerlink" href="#chapter-2-hello-framework" title="Permalink to this headline">¶</a></h2>
<p>Create a Code directory for your work.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ mkdir code
</pre></div>
</div>
<p>Move in.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> code
</pre></div>
</div>
<p>Create a new directory for your project.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ mkdir first-graphics-app
</pre></div>
</div>
<p>Use <code class="docutils literal"><span class="pre">npm</span></code> to install <a class="reference external" href="http://yeoman.io/">yeoman</a> (a tempate and scaffolding system) and <a class="reference external" href="https://gulpjs.com/">gulp</a> (a task runner).</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ sudo npm install -g yo gulp
</pre></div>
</div>
<p>Use npm to install <a class="reference external" href="https://github.com/larsonjj/generator-yeogurt">yeogurt</a>, our project generator that yeoman will build.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ sudo npm install -g generator-yeogurt
</pre></div>
</div>
<p>Create a new project.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ yo yeogurt
</pre></div>
</div>
<p>Be sure to pick “nunjucks” when creating the project.</p>
<p>Fire up the test server</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ gulp serve
</pre></div>
</div>
<p>Visit <a class="reference external" href="http://localhost:3000">localhost:3000</a> in your browser.</p>
<p>Replace the content of <code class="docutils literal"><span class="pre">src/index.nunjucks</span></code> with the below line, and see it show up on the live site.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Welcome to First Graphics App!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Open a second terminal and navigate to your code folder.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> code
$ <span class="nb">cd</span> first-graphics-app
</pre></div>
</div>
<p>Commit our work.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git add .
$ git commit -m <span class="s2">&quot;Installed framework&quot;</span>
</pre></div>
</div>
<p>Push it to GitHub.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git push origin master
</pre></div>
</div>
</div>
<div class="section" id="chapter-3-hello-template">
<h2>Chapter 3: Hello template<a class="headerlink" href="#chapter-3-hello-template" title="Permalink to this headline">¶</a></h2>
<p>Navigate to <a class="reference external" href="http://localhost:3000/">localhost:3000/</a>.</p>
<p>Make a change to <code class="docutils literal"><span class="pre">index.nunjucks</span></code> by editing the <code class="docutils literal"><span class="pre">content</span></code> block. See it show up.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% block content %}
&lt;p&gt;Hello World&lt;/p&gt;
{% endblock %}
</pre></div>
</div>
<p>Open up <code class="docutils literal"><span class="pre">_layouts/base.nunjucks</span></code> and explain how the template inheritance system works.</p>
<p>Make a small change to <code class="docutils literal"><span class="pre">_layouts/base.nunjucks</span></code> and see it come up live.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>Above content
{% block content %}{% endblock %}
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">_layouts/base.nunjucks</span></code> with our more polished base template.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
    &lt;title&gt;First Graphics App&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;styles/main.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://bl.ocks.org/palewire/raw/1035cd306a2f85b362b1a20ce315b8eb/base.css?rev=4&quot;&gt;
    {% block stylesheets %}{% endblock %}
&lt;/head&gt;
&lt;body&gt;
    &lt;nav&gt;
        &lt;a href=&quot;http://first-graphics-app.readthedocs.org/&quot;&gt;
            &lt;img src=&quot;https://bl.ocks.org/palewire/raw/1035cd306a2f85b362b1a20ce315b8eb/ire-logo.png&quot;&gt;
        &lt;/a&gt;
    &lt;/nav&gt;
    &lt;header&gt;
        &lt;h1&gt;{% block headline %}{% endblock %}&lt;/h1&gt;
        &lt;div class=&quot;byline&quot;&gt;
            {% block byline %}{% endblock %}
        &lt;/div&gt;
        &lt;div class=&quot;pubdate&quot;&gt;
            {% block pubdate %}{% endblock %}
        &lt;/div&gt;
    &lt;/header&gt;
    {% block content %}{% endblock %}
    {% block scripts %}{% endblock %}
    &lt;script src=&quot;scripts/main.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>Fill in a headline and see it show up.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% block headline %}My headline will go here{% endblock %}
</pre></div>
</div>
<p>Fill in a byline and see it show up.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% block byline %}By me{% endblock %}
</pre></div>
</div>
<p>Let’s do the publication date too while we are at it.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% block pubdate %}
    &lt;time datetime=&quot;2018-03-10&quot; pubdate&gt;Mar. 10, 2018&lt;/time&gt;
{% endblock %}
</pre></div>
</div>
<p>Commit our work.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git add .
$ git commit -m <span class="s2">&quot;Started editing templates&quot;</span>
</pre></div>
</div>
<p>Push it to GitHub.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git push origin master
</pre></div>
</div>
</div>
<div class="section" id="chapter-4-hello-data">
<h2>Chapter 4: Hello data<a class="headerlink" href="#chapter-4-hello-data" title="Permalink to this headline">¶</a></h2>
<p>Add the <a class="reference external" href="https://raw.githubusercontent.com/ireapps/first-graphics-app/master/src/_data/harvard_park_homicides.json">Harvard Park homicides data files</a> to <code class="docutils literal"><span class="pre">_data/harvard_park_homicides.json</span></code></p>
<p>Return to <code class="docutils literal"><span class="pre">src/harvard-park-homicides/index.nunjucks</span></code> and print them out on the page.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% block content %}
{{ site.data.harvard_park_homicides }}
{% endblock %}
</pre></div>
</div>
<p>Loop through them and print them all.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% for obj in site.data.harvard_park_homicides %}
    {{ obj }}
{% endfor %}
</pre></div>
</div>
<p>Print the last name.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% for obj in site.data.harvard_park_homicides %}
    {{ obj.last_name }}&lt;br&gt;
{% endfor %}
</pre></div>
</div>
<p>Add the first name. To have them display more nicely, you can also add a line break in between each one.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% for obj in site.data.harvard_park_homicides %}
    {{ obj.first_name }} {{ obj.last_name }}&lt;br&gt;
{% endfor %}
</pre></div>
</div>
<p>Commit our work.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git add .
$ git commit -m <span class="s2">&quot;Printed a list of names from data&quot;</span>
</pre></div>
</div>
<p>Push it to GitHub.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git push origin master
</pre></div>
</div>
</div>
<div class="section" id="chapter-5-hello-table">
<h2>Chapter 5: Hello table<a class="headerlink" href="#chapter-5-hello-table" title="Permalink to this headline">¶</a></h2>
<p>TK</p>
</div>
<div class="section" id="chapter-6-hello-chart">
<h2>Chapter 6: Hello chart<a class="headerlink" href="#chapter-6-hello-chart" title="Permalink to this headline">¶</a></h2>
<p>We have data, but what does it look like? To visualize our data, we’re going to use <a class="reference external" href="https://plot.ly/javascript/">plotly.js</a>. Plotly.js is an open source library built on the popular <a class="reference external" href="https://d3js.org/">D3</a> library, which powers a lot of the news graphics made with JavaScript you’ll see.</p>
<p>First, use npm to install plotly.js.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ npm install -s plotly.js
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">-s</span></code> argument saves plotly to a dependencies file. That way, if you ever need to go through the install steps for your app again, you can do so easily.</p>
<p>From here, we’ll be working in our <code class="docutils literal"><span class="pre">_scripts</span></code> folder. Create a file called <code class="docutils literal"><span class="pre">charts.js</span></code> inside of <code class="docutils literal"><span class="pre">src/_scripts/</span></code>.</p>
<p>You can include the libraries we installed (or any JavaScript file!) by using <code class="docutils literal"><span class="pre">require()</span></code>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">Plotly</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;plotly.js&#39;</span><span class="p">);</span>

<span class="c1">// At the end of the charts.js file</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello, this is my charts file!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we use the same <code class="docutils literal"><span class="pre">require()</span></code> method to pull our code into <code class="docutils literal"><span class="pre">main.js</span></code>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">chart</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./charts.js&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Structuring our code this way helps keep things organized, as each file controls one specific part of the page. Need to make an adjustment to your chart? Go to <code class="docutils literal"><span class="pre">charts.js</span></code>. Want to tweak the map (which we’ll do later)? Look in <code class="docutils literal"><span class="pre">map.js</span></code></p>
<p>Now if you reload your page and go to your inspector (click on the three dots in the top right of Chrome, go down to “More tools” and select “Developer tools”), you should see <code class="docutils literal"><span class="pre">hello,</span> <span class="pre">this</span> <span class="pre">is</span> <span class="pre">my</span> <span class="pre">charts</span> <span class="pre">file!</span></code> in the console.</p>
<p>TK PICTURE OF INSPECTOR / CONSOLE HERE</p>
<p>What chart should we make? The story points out that Harvard Park experienced an increase in homicides as there was a decrease across the rest of the city. Let’s try to visualize that.</p>
<p>First, we need somewhere for our charts to go. In our <code class="docutils literal"><span class="pre">harvard-park-homicides/index.nunjucks</span></code> file, inside of <code class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">content</span> <span class="pre">%}</span></code> where you want the chart to go, create a <code class="docutils literal"><span class="pre">div</span></code> element with an id of “city-homicides”, and another with an id of “harvard-park-homicides”.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;city-homicides&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;harvard-park-homicides&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Meanwhile, we need data. Copy the <a class="reference external" href="https://raw.githubusercontent.com/ireapps/first-graphics-app/master/src/_data/annual_totals.json">annual totals data</a> to <code class="docutils literal"><span class="pre">_data/annual_totals.json</span></code>. We can use nunjucks to include our data file directly in the template.</p>
<p>Inside of the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">scripts</span> <span class="pre">%}</span></code> block:</p>
<div class="highlight-html"><div class="highlight"><pre><span></span>{% block scripts %}
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="kd">var</span> <span class="nx">homicides</span> <span class="o">=</span> <span class="p">{</span><span class="o">%</span> <span class="nx">include</span> <span class="s1">&#39;_data/annual_totals.json&#39;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
{% endblock %}
</pre></div>
</div>
<p>Making a chart in Plotly is simple, but we have to do some data transformation first. Plotly wants the x and y values of the chart to be in arrays, which are like a list of values.</p>
<p>We want to make two charts - one of city homicides and one of killings in Harvard Park. So let’s make arrays that will hold those values that we will then provide to our function, as well as the years.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// Initialize the arrays that will hold our lists of data</span>
<span class="kd">var</span> <span class="nx">cityHomicides</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">harvardParkHomicides</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">years</span> <span class="o">=</span> <span class="p">[];</span>
</pre></div>
</div>
<p>Then we want to fill our arrays by looping over each item in our <code class="docutils literal"><span class="pre">data</span></code> by using a <code class="docutils literal"><span class="pre">.forEach()</span></code> loop.  <code class="docutils literal"><span class="pre">.forEach()</span></code> goes through every item in our list of homicides.  <code class="docutils literal"><span class="pre">.push()</span></code> adds values into the arrays we’ve created.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">cityHomicides</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">harvardParkHomicides</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">years</span> <span class="o">=</span> <span class="p">[];</span>

<span class="nx">homicides</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">cityHomicides</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">[</span><span class="s1">&#39;homicides_total&#39;</span><span class="p">]);</span>
  <span class="nx">harvardParkHomicides</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">[</span><span class="s1">&#39;homicides_harvard_park&#39;</span><span class="p">]);</span>
  <span class="nx">years</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">row</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Now that we’ve populated our data, we’re ready to make our chart. Right now, it’s pretty simple, with options for the x, which we want to be our <code class="docutils literal"><span class="pre">years</span></code> array, and y axis, which is our homicide counts, and specifying the type of the chart.</p>
<p>Below the settings we call <code class="docutils literal"><span class="pre">Plotly.newPlot()</span></code> with the id of the element where we want the chart to go and settings to create the chart.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// Use our x and y arrays for the values of the chart</span>
<span class="kd">var</span> <span class="nx">settings</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="nx">x</span><span class="o">:</span> <span class="nx">years</span><span class="p">,</span>
    <span class="nx">y</span><span class="o">:</span> <span class="nx">cityHomicides</span><span class="p">,</span>
    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span>
<span class="p">}];</span>

<span class="c1">// Create the chart</span>
<span class="nx">Plotly</span><span class="p">.</span><span class="nx">newPlot</span><span class="p">(</span><span class="s1">&#39;city-homicides&#39;</span><span class="p">,</span> <span class="nx">settings</span><span class="p">);</span>
</pre></div>
</div>
<p>This is a good start, but we can further customize this chart so it fits better with the rest of the page. Now, let’s try to:</p>
<ul class="simple">
<li>Add axis labels</li>
<li>Change the colors of the bars</li>
<li>Change the fonts to match our page</li>
<li>Give the charts titles</li>
<li>Display the two charts alongside one another</li>
</ul>
<p>Let’s add labels to our axes. Create a new variable, <code class="docutils literal"><span class="pre">chartLayout</span></code> in your <code class="docutils literal"><span class="pre">createChart</span></code> function. We can then specify properties for <code class="docutils literal"><span class="pre">xaxis</span></code> and yaxis``.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">layout</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">xaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Year&#39;</span>
    <span class="p">},</span>
    <span class="nx">yaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Homicides&#39;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Then, add <code class="docutils literal"><span class="pre">layout</span></code> as a third argument to <code class="docutils literal"><span class="pre">Plotly.newPlot()</span></code></p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">Plotly</span><span class="p">.</span><span class="nx">newPlot</span><span class="p">(</span><span class="s1">&#39;city-homicides&#39;</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">layout</span><span class="p">);</span>
</pre></div>
</div>
<p>Everything in plotly.js is handled by settings like this. For example, to change the markers to an light blue, update <code class="docutils literal"><span class="pre">settings</span></code>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">settings</span> <span class="o">=</span> <span class="p">[{</span>
  <span class="nx">x</span><span class="o">:</span> <span class="nx">years</span><span class="p">,</span>
  <span class="nx">y</span><span class="o">:</span> <span class="nx">cityHomicides</span><span class="p">,</span>
  <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
  <span class="c1">// Add the new settings for marker here</span>
  <span class="nx">marker</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#86c7df&#39;</span>
  <span class="p">}</span>
<span class="p">}];</span>
</pre></div>
</div>
<p>But wait, what if you want to make another chart? You’d have to copy and paste all that code over again.</p>
<p>Before we get to far, let’s abstract all of this into a function.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">createChart</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The code that creates our chart will go here.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is the start of a function that will take values for the x and y axes, and an HTML element, and create a chart with the data inside the element.</p>
<p>Now copy and paste the <code class="docutils literal"><span class="pre">settings</span></code>, <code class="docutils literal"><span class="pre">layout</span></code> and the call to <code class="docutils literal"><span class="pre">Plotly.newPlot()</span></code> into the createChart function. Change the variables <code class="docutils literal"><span class="pre">years</span></code> and <code class="docutils literal"><span class="pre">cityHomicides</span></code> to <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code>.</p>
<p>Note also that we change <code class="docutils literal"><span class="pre">'city-homicides'</span></code> to <code class="docutils literal"><span class="pre">element</span></code> in the call to <code class="docutils literal"><span class="pre">Plotly.newPlot()</span></code>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">createChart</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The code that creates our chart will go here.</span>
    <span class="kd">var</span> <span class="nx">settings</span> <span class="o">=</span> <span class="p">[{</span>
      <span class="nx">x</span><span class="o">:</span> <span class="nx">x</span><span class="p">,</span>
      <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span><span class="p">,</span>
      <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
      <span class="nx">marker</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#86c7df&#39;</span>
      <span class="p">}</span>
    <span class="p">}];</span>

    <span class="kd">var</span> <span class="nx">layout</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">xaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Year&#39;</span>
      <span class="p">},</span>
      <span class="nx">yaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Homicides&#39;</span>
      <span class="p">}</span>
    <span class="p">};</span>

    <span class="c1">// Create the chart</span>
    <span class="nx">Plotly</span><span class="p">.</span><span class="nx">newPlot</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">layout</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, if you reload the page, you won’t see your chart anymore! That’s because we’ve defined the function, but we haven’t called it.</p>
<p>To call the function, add this line to the end of your file.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// The rest of your code is up here</span>
<span class="nx">createChart</span><span class="p">(</span><span class="nx">years</span><span class="p">,</span> <span class="nx">cityHomicides</span><span class="p">,</span> <span class="s1">&#39;city-homicides&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Now, we can make a second chart by using the Harvard Park data. Be sure to replace the ID of the element you’re building the chart in.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// The rest of your code is up here</span>
<span class="nx">createChart</span><span class="p">(</span><span class="nx">years</span><span class="p">,</span> <span class="nx">harvardParkHomicides</span><span class="p">,</span> <span class="s1">&#39;harvard-park-homicides&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Not bad, right? By structuring our code this way, we’ll be able to make multiple charts without repeating our code (known as <a class="reference external" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a>).</p>
<p>Right now, our charts are stacked up on top of each other, which isn’t a very nice layout. We can use HTML and CSS to lay out our charts side-by-side.</p>
<p>In <code class="docutils literal"><span class="pre">index.nunjucks</span></code>, add a <code class="docutils literal"><span class="pre">div</span></code> element that wraps your charts, and add a <code class="docutils literal"><span class="pre">class</span></code> of <code class="docutils literal"><span class="pre">inline-chart</span></code> to each of your charts.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;charts-holder&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;inline-chart&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;city-homicides&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;inline-chart&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;harvard-park-homicides&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>This gives us a structure that we can style with CSS. In the <code class="docutils literal"><span class="pre">_scripts</span></code> folder, create a file called <code class="docutils literal"><span class="pre">_charts.scss</span></code>. In that file, copy or write the following:</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">inline-chart</span> <span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">49</span><span class="kt">%</span><span class="p">;</span>
    <span class="k">float</span><span class="p">:</span> <span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You won’t see anything yet, because we haven’t imported it into our main stylesheet. Use <code class="docutils literal"><span class="pre">&#64;import</span></code> to bring your CSS file into <code class="docutils literal"><span class="pre">main.css</span></code></p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="nt">Normalize</span> <span class="nt">Styles</span>
<span class="p">@</span><span class="k">import</span> <span class="s1">&#39;node_modules/normalize.css/normalize&#39;</span><span class="p">;</span>

<span class="o">//</span> <span class="nt">Import</span> <span class="nt">Modules</span>
<span class="p">@</span><span class="k">import</span> <span class="s1">&#39;../_modules/link/link&#39;</span><span class="p">;</span>

<span class="o">//</span> <span class="nt">Add</span> <span class="nt">this</span> <span class="nt">to</span> <span class="nt">main</span><span class="p">.</span><span class="nc">scss</span>
<span class="p">@</span><span class="k">import</span> <span class="s1">&#39;_charts.scss&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Again, this is the same modular structure that allows us to organize our chart styles in a different place from our map styles, for example.</p>
<p>The charts are laid out side-by-side like we want them, but there’s way too much space in between them. Luckily, we can adjust the margins in the chart layout. Back in <code class="docutils literal"><span class="pre">_scripts/charts.js</span></code>, the following settings should work.</p>
<p><code class="docutils literal"><span class="pre">l</span></code>, <code class="docutils literal"><span class="pre">r</span></code>, <code class="docutils literal"><span class="pre">t</span></code> and <code class="docutils literal"><span class="pre">b</span></code> stand for left, right, top and bottom margins, respectively.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">chartLayout</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">xaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Year&#39;</span>
    <span class="p">},</span>
    <span class="nx">yaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Homicides&#39;</span>
    <span class="p">},</span>
    <span class="c1">// Add the margin here</span>
    <span class="nx">margin</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">l</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span>
        <span class="nx">r</span><span class="o">:</span> <span class="mi">15</span><span class="p">,</span>
        <span class="nx">t</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span>
        <span class="nx">b</span><span class="o">:</span> <span class="mi">30</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>We can also add a parameter to reduce the height, they’re a bit tall.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">chartLayout</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// Other properties are above</span>
    <span class="c1">// Add a height parameter to the bottom of your file</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">250</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Another nice modification - we can make the annoying toolbar go away by adjusting our call to <code class="docutils literal"><span class="pre">Plotly.newPlot()</span></code></p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">Plotly</span><span class="p">.</span><span class="nx">newPlot</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">layout</span><span class="p">,</span> <span class="p">{</span><span class="nx">displayModeBar</span><span class="o">:</span> <span class="kc">false</span><span class="p">});</span>
</pre></div>
</div>
<p>Much better! There are a couple more customization options we can do with plotly. While it’s useful to get the homicide numbers on hover, we don’t really need those year label popups. We can turn those off by only displaying hovers for y-axis values.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">createChart</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">settings</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="nx">x</span><span class="o">:</span> <span class="nx">x</span><span class="p">,</span>
    <span class="nx">y</span><span class="o">:</span> <span class="nx">y</span><span class="p">,</span>
    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
    <span class="nx">marker</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#86c7df&#39;</span>
    <span class="p">},</span>
    <span class="c1">// Add this to your chart settings</span>
    <span class="nx">hoverinfo</span><span class="o">:</span> <span class="s1">&#39;y&#39;</span>
  <span class="p">}];</span>

  <span class="c1">// the rest of your code is down here</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Last, our charts need titles! Since we want each chart to have a different title, we’ll need to update our function a bit.</p>
<dl class="docutils">
<dt>We’re going to</dt>
<dd><ul class="first last simple">
<li>add an argument to our <code class="docutils literal"><span class="pre">createChart</span></code> function for the title,</li>
<li>feed that title to our chart options,</li>
<li>update our calls to provide that title</li>
</ul>
</dd>
</dl>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">// Note the new &#39;title&#39; argument</span>
<span class="kd">function</span> <span class="nx">createChart</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">title</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// More of the function is up here</span>
    <span class="p">...</span>

    <span class="c1">// Add a &#39;title&#39; parameter to the layout properties</span>
    <span class="kd">var</span> <span class="nx">layout</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">title</span><span class="o">:</span> <span class="nx">title</span><span class="p">,</span>
      <span class="nx">xaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Year&#39;</span>
      <span class="p">},</span>
      <span class="nx">yaxis</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Homicides&#39;</span>
      <span class="p">},</span>
      <span class="c1">// Add the margin here</span>
      <span class="nx">margin</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">l</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span>
        <span class="nx">r</span><span class="o">:</span> <span class="mi">15</span><span class="p">,</span>
        <span class="nx">t</span><span class="o">:</span> <span class="mi">45</span><span class="p">,</span>
        <span class="nx">b</span><span class="o">:</span> <span class="mi">30</span>
      <span class="p">},</span>
      <span class="nx">height</span><span class="o">:</span> <span class="mi">250</span>
    <span class="p">};</span>

    <span class="c1">// Create the chart</span>
    <span class="nx">Plotly</span><span class="p">.</span><span class="nx">newPlot</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">settings</span><span class="p">,</span> <span class="nx">layout</span><span class="p">,</span> <span class="p">{</span><span class="nx">displayModeBar</span><span class="o">:</span> <span class="kc">false</span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, add the title you want to your function call. We’ll assign them to variables first for cleanliness.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">cityChartTitle</span> <span class="o">=</span> <span class="s2">&quot;City Homicides, 2000-2017&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">hpChartTitle</span> <span class="o">=</span> <span class="s2">&quot;Harvard Park Homicides, 2000-2017&quot;</span><span class="p">;</span>

<span class="nx">createChart</span><span class="p">(</span><span class="nx">years</span><span class="p">,</span> <span class="nx">cityHomicides</span><span class="p">,</span> <span class="s1">&#39;city-homicides&#39;</span><span class="p">,</span> <span class="nx">cityChartTitle</span><span class="p">);</span>
<span class="nx">createChart</span><span class="p">(</span><span class="nx">years</span><span class="p">,</span> <span class="nx">harvardParkHomicides</span><span class="p">,</span> <span class="s1">&#39;harvard-park-homicides&#39;</span><span class="p">,</span> <span class="nx">hpChartTitle</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="chapter-7-hello-map">
<h2>Chapter 7: Hello map<a class="headerlink" href="#chapter-7-hello-map" title="Permalink to this headline">¶</a></h2>
<p>Install Leaflet with npm.</p>
<div class="highlight-base"><div class="highlight"><pre><span></span>$ npm install -s leaflet
</pre></div>
</div>
<p>Import Leaflet’s JavaScript in <cite>_scripts/main.js</cite>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">L</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;leaflet&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Add a little hack we’ll need to get the images to work.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">L</span><span class="p">.</span><span class="nx">Icon</span><span class="p">.</span><span class="nx">Default</span><span class="p">.</span><span class="nx">imagePath</span> <span class="o">=</span> <span class="s1">&#39;https://unpkg.com/leaflet@1.3.1/dist/images/&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Import Leaflet’s stylesheets in <cite>_styles/main.scss</cite></p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">import</span> <span class="s1">&#39;node_modules/leaflet/dist/leaflet&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Create a placeholder in the page template where the map will live.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% block content %}
&lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
{% endblock %}
</pre></div>
</div>
<p>Add a new file named <cite>map.js</cite> to the <cite>_scripts</cite> directory. Import it in <cite>main.js</cite>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;./map.js&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Now in <cite>map.js</cite> paste in the following Leaflet code to generate a simple map.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">&#39;map&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">osm</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;</span><span class="p">);</span>
<span class="nx">osm</span><span class="p">.</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span><span class="sb">`</span>
</pre></div>
</div>
<p>Reload the index page to see the results.</p>
<p>Go to Google Maps and find 62nd Street and Harvard Boulevard in South LA. Hold down a click until it gives you the latitude and longitude. Paste those numbers into Leaflet’s setView method.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">([</span><span class="mf">33.983265</span><span class="p">,</span> <span class="o">-</span><span class="mf">118.306799</span><span class="p">],</span> <span class="mi">15</span><span class="p">);</span>
</pre></div>
</div>
<p>Move in the zoom.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">([</span><span class="mf">33.983265</span><span class="p">,</span> <span class="o">-</span><span class="mf">118.306799</span><span class="p">],</span> <span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
<p>Add a pin at that point.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([</span><span class="mf">33.983265</span><span class="p">,</span> <span class="o">-</span><span class="mf">118.306799</span><span class="p">]).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
</pre></div>
</div>
<p>Add a popup.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">marker</span><span class="p">.</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s2">&quot;W. 62nd Street and Harvard Boulevard&quot;</span><span class="p">).</span><span class="nx">openPopup</span><span class="p">();</span>
</pre></div>
</div>
<p>At the bottom of the page import in the homicide list as we did with the totals for our chart.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>var homicides = {% include &#39;_data/harvard_park_homicides.json&#39; %};
</pre></div>
</div>
<p>Loop through the data in <cite>map.js</cite> and add each point to the map as a circle, just like the real Homicide Report.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">homicides</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">circleMarker</span><span class="p">([</span><span class="nx">obj</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span>  <span class="nx">obj</span><span class="p">.</span><span class="nx">longitude</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Extend that code to add a tooltip label on each point.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">homicides</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">circleMarker</span><span class="p">([</span><span class="nx">obj</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span>  <span class="nx">obj</span><span class="p">.</span><span class="nx">longitude</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">bindTooltip</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">first_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">last_name</span><span class="p">);</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Sprinkle some CSS in our page to make it match the colors.</p>
<div class="highlight-nunjucks"><div class="highlight"><pre><span></span>{% block stylesheets %}
&lt;style&gt;
    path {
        fill: #e64d1f;
        fill-opacity: 0.5;
        stroke-opacity: 0;
    }
&lt;/style&gt;
{% endblock %}
</pre></div>
</div>
<p>Now add an option to the tooltip that makes them all visible all the time.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">homicides</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">L</span><span class="p">.</span><span class="nx">circleMarker</span><span class="p">([</span><span class="nx">obj</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span>  <span class="nx">obj</span><span class="p">.</span><span class="nx">longitude</span><span class="p">])</span>
      <span class="p">.</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">bindTooltip</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">first_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">last_name</span><span class="p">,</span> <span class="p">{</span><span class="nx">permanent</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Now let’s add a mini map in the corner yet for context.</p>
<p>Install Leaflet-minimap.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ npm install -s leaflet-minimap
</pre></div>
</div>
<p>Add it to <cite>_scripts/main.js</cite>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MiniMap</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;leaflet-minimap&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Add the stylesheets.</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="p">@</span><span class="k">import</span> <span class="s1">&#39;node_modules/leaflet-minimap/src/Control.MiniMap&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Create a minimap in the corner</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">osm2</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">maxZoom</span><span class="o">:</span> <span class="mi">9</span>
<span class="p">});</span>
<span class="kd">var</span> <span class="nx">mini</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">Control</span><span class="p">.</span><span class="nx">MiniMap</span><span class="p">(</span><span class="nx">osm2</span><span class="p">,</span> <span class="p">{</span> <span class="nx">toggleDisplay</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>
<span class="nx">mini</span><span class="p">.</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
</pre></div>
</div>
<p>Add a deck headline.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>One corner. Four killings. <span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Write a section graf.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>The southwest corner of Harvard Park, at West 62nd Street and Harvard Boulevard, has been especially deadly. In the last year-and-a-half, four men have been killed there — while sitting in a car, trying to defuse an argument or walking home from the barber shop or the corner store.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Wrap it in a section tag.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">section</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>One corner. Four killings. <span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>The southwest corner of Harvard Park, at West 62nd Street and Harvard Boulevard, has been especially deadly. In the last year-and-a-half, four men have been killed there — while sitting in a car, trying to defuse an argument or walking home from the barber shop or the corner store.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="chapter-8-hello-internet">
<h2>Chapter 8: Hello Internet<a class="headerlink" href="#chapter-8-hello-internet" title="Permalink to this headline">¶</a></h2>
<p>Build a static version of your site</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ gulp --production
</pre></div>
</div>
<p>Inspect the files in the build directory.</p>
<p>Edit <code class="docutils literal"><span class="pre">package.json</span></code> to build files to docs instead.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="s2">&quot;destination&quot;</span><span class="o">:</span> <span class="s2">&quot;docs&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>Build the static site again.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ gulp --production
</pre></div>
</div>
<p>Commit and push to GitHub.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git add package.json
$ git add docs
$ git commit -am <span class="s2">&quot;Message here&quot;</span>
$ git push origin master
</pre></div>
</div>
<p>Go to GitHub config and turn on GitHub Pages with the <code class="docutils literal"><span class="pre">/docs</span></code> on the master branch as the source. Hit save.</p>
<p>Visit <a class="reference external" href="https://ireapps.github.io/first-graphics-app/">&lt;your_username&gt;.github.com/first-graphics-app/</a>.</p>
<p>Visit <a class="reference external" href="https://ireapps.github.io/first-graphics-app/harvard-park-homicides/">&lt;your_username&gt;.github.com/first-graphics-app/harvard-park-homicides</a>.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, IRE/NICAR.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>